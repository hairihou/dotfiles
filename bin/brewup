#!/usr/bin/env bash
set -euo pipefail

brew update
brew upgrade --formula

casks="$(brew list --cask)"
[[ "$*" != *--all* && -n "$casks" ]] && casks=$(echo "$casks" | grep -v '@' || echo '')
[[ -n "$casks" ]] && echo "$casks" | xargs brew upgrade --greedy --cask

brew cleanup --prune=all --scrub
brew autoremove
