#!/usr/bin/env bash
set -euo pipefail

count=0
while IFS= read -r dir; do
  [[ "$dir" == ./.git* ]] && continue

  if rmdir "$dir" 2>/dev/null; then
    echo "Removed: $dir"
    ((count++))
  fi
done < <(find . -type d -empty 2>/dev/null | sort -r)

if ((count == 0)); then
  echo "No empty directories found"
else
  echo "Removed $count empty director$([[ $count -eq 1 ]] && echo 'y' || echo 'ies')"
fi
